<!--
    SEARCH RESULTS PAGE
    This is the template for displaying the IR system's results from someone's query.
-->

<html>

<head>
    <title>Similar Singer</title>
    <link rel="icon" href="/static/img/record_logo.png">
    <link rel="stylesheet" href="/static/style/bootstrap.min.css">
    <link rel="stylesheet" href="/static/style/global.css">
    <link rel="stylesheet" href="/static/style/results.css">
    <script src="/static/scripts/jquery-3.6.0.js"></script>
</head>

<body>
    <!-- RESULTS PAGE HEADER -->
    <div id="results-header">
        <div class="logo"><a href="/"><img class="record_icon" src="/static/img/record_bordered_logo.svg"></a></div>
        <div class="title noselect">
            <a href="/">
                <h1>{{ name }}</h1>
            </a>
            <form class="global-search" method="GET" autocomplete="off">
                <div id="search_fields">
                    <div class="search_item"><input class="search fav_artist" id="input" type="text" name="search"
                            placeholder="your favorite artist" value="{{query_info['artist_name']}}"></div>
                    <div class="search_item"><input class="search ling_desc" id="input" type="text" name="ling_desc"
                            placeholder="describe a mood, tempo, rhythm, etc." value="{{query_info['ling_desc']}}">
                    </div>
                    <div class="search_item"><input class="search disliked_artist" id="input" type="text"
                            name="disliked_artist" placeholder="which artist do you NOT like?"
                            value="{{query_info['disliked_artist']}}"></div>
                    <button class="sb_submit" type="submit"> â–¶ </button>
                </div>
            </form>
        </div>
    </div>
    <!-- RESULTS PAGE RESULTS -->
    <div id="results-container">{% if data %}
        <h3>{{output_message}}</h3>
        <div class="results list">
            {% for d in data %}
            {% set genres = d['common_genres'].split(',') %}
            <div class="card item">
                <div class="left"><img src="{{ d['img_url'] }}"></div>
                <div class="right">
                    <div class="result-title">
                        <h4>{{ d['artist_name'] }}</h4>
                        <div class="spotify followers" data-followers="{{ d['follower_count'] }}"><img src="/static/img/spotify.png"/></div>
                    </div>
                    <p>{{ "Similarity score: " + d['sim_score'] }}</p>
                    <p>{{ "Genres in common: " + d['common_genres'] }}</p>
                    <div class="genre-tags">{% for g in genres %} <span class="tag">{{g}}</span> {% endfor %}</div>
                    <iframe class="spotify-player" data-active="false" src={{ "https://open.spotify.com/embed/artist/" + d['artist_id'] }} width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                </div>
            </div>
            {% endfor %}
        </div>
    {% endif %}</div>

<!--    &lt;!&ndash; RESULTS PAGE RESULTS &ndash;&gt;-->
<!--    <div id="results-container">-->
<!--        <div class="main bar">-->
<!--            <form class="form-inline global-search">-->
<!--                {% if data %}-->
<!--                <h3>{{output_message}}</h3>-->
<!--                <div class="results list">-->
<!--                    {% for d in data %}-->
<!--                    <div class="item">-->
<!--                        <div class="left"><img src="{{ d['img_url'] }}"></div>-->
<!--                        <div class="right">-->
<!--                            <div class="result-title">-->
<!--                                <h4>{{ d['artist_name'] }}</h4>-->
<!--                                <div class="spotify"><img src="/static/img/spotify.png"/> {{ d['follower_count'] }} spotify followers </div>-->
<!--                            </div>-->
<!--                            <p>{{ "Similarity score: " + d['sim_score'] }}</p>-->
<!--                            <p>{{ "Genres in common: " + d['common_genres'] }}</p>-->
<!--&lt;!&ndash;                            <p>{{ d['description'] }}</p>&ndash;&gt;-->
<!--                            <iframe src={{ "https://open.spotify.com/embed/artist/" + d['artist_id'] }} width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    {% endfor %}-->
<!--                </div>-->
<!--                {% endif %}-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->
</body>
<script src="/static/scripts/search_autocomplete.js"></script>
<script src="/static/scripts/results.js"></script>
<script>
    // Instantiating code goes here so that we can make use of Flask templates
    let artists = [{% for artist in artist_names %}'{{artist}}', {% endfor %}""].slice(0, -1);

    initAutoCompleteDropdown(document.getElementsByClassName("fav_artist")[0], artists);
    initAutoCompleteDropdown(document.getElementsByClassName("disliked_artist")[0], artists);
</script>

</html>